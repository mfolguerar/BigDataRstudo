---
title: "Practica1.1"
author: "mfolguer"
date: "2023-02-22"
output: html_document
---

#1. Estudiar el modelo de regresi칩n simple de la variable medv sobre lstat (el porcentaje de propietarios con bajo estatus socioecon칩mico).

```{r}
library(MASS)
attach(Boston)
modelo<-lm(medv~lstat)
summary(modelo)

library(ggplot2)
grafico1<-ggplot(Boston,aes(lstat,medv))+
geom_point(colour="green")+
geom_smooth(method="lm",se=F,colour="red")+
theme_bw()
plot(grafico1)

```

#2. 쮺u치l es la recta de regresi칩n para este modelo? 쯈u칠 coeficiente de 洧녠2 se alcanza con este modelo?

```{r}
x1=cov(medv,lstat)/var(lstat)
x2=mean(medv)-x1*mean(lstat)
#Recta de regresion=x1*lstat+x2   ->-0.95*lstat+34.55

#Precision del modelo
library(stats)
modelo<-lm(medv~lstat)
n=length(lstat)
SCT=sum((medv-mean(medv))^2)
SCR=sum(residuals(modelo)^2)
R2=(SCT-SCR)/SCT
#El R^2 es 0,54
R2

```

#3. Supongamos que tenemos una vivienda en una nueva zona con un estatus socioecon칩mico (lstat) de 23.4, seg칰n el modelo de regresi칩n simple ajustado, 쯤u칠 predicci칩n se obtiene para la mediana del valor de una vivienda en esta zona?

```{r}
library(MASS)
attach(Boston)
nuevo_lstat <- data.frame(lstat = 23.4)
prediccion <- predict(modelo, newdata = nuevo_lstat)
prediccion
```

#4. Haciendo uso de un modelo de selecci칩n de variables hacia atr치s (backward), 쯖u치les son las 5 variables m치s importantes a la hora de predecir la mediana de los valores de la vivienda? Indica cu치l es la recta de regresi칩n resultante para este modelo

```{r}
library(MASS)
attach(Boston)
#  modelo  con todas las variables predictoras
modelo <- lm(medv ~ ., data = Boston)
#  el modelo  utilizando backward
modelo1 <- step(modelo, direction = "backward")
summary(modelo1)
#Teniendo en cuenta el valor numerico de p-valor en cada iteracion hacia atras
#Las 5 variables mas significativas serian: rm,ptratio,black,lstat,tax


```

#5쯉e aprecia una gran diferencia entre el ajuste producido por el modelo que incluye todas las variables regresoras y el modelo de regresi칩n que cuenta con las 5 variables m치s importantes? Justifica la respuesta

```{r}
library(MASS)
attach(Boston)
modelo <- lm(medv ~ ., data = Boston)
summary(modelo)
#R de 0.741
modelo1 <- lm(medv ~ rm + ptratio + black + lstat + tax, data = Boston)
summary(modelo1)
#R de 0.716
#la diferencia entre los R no es significativa
#PEro el modelo que tiene todas las variables tiene un mejor ajuste y es mas preciso
#Entonces se aprecia diferencia pero es mas ajustado usar todas las variables


```

#6. Bas치ndote en el modelo de regresi칩n que incluye 5 variables: Estudia si se verifican las hip칩tesis del modelo. #쮺onsideras que es un modelo apropiado para predecir los valores medianos de la vivienda en Boston? Justifica tu respuesta.

```{r}
library(MASS)
attach(Boston)
modelo <- lm(medv ~ rm + ptratio + black + lstat + tax, data = Boston)
summary(modelo)
#Normalidad =No hay distribucion normal
shapiro.test(resid(modelo))

#homocedasticidad =sin varianza constante
library(lmtest)
bptest(modelo)

#Linealidad =no lineal
library(car)
resettest(modelo)

#Residuos 
par(mfrow = c(2, 2))
plot(modelo)

#LAS HIPOTESIS DEL MODELO SE CUMPLEN


#Ya que las hipotesis del modelo se cumplen para 5 variables es bastante esperanzador pero como disponemos de otras variables mas en el paquete MASS que ofrecen resultados mas ajustados seria conveniente usarlas


```
