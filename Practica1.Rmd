---
title: "Practica1"
author: "mfolguer"
date: "2023-02-19"
output: word_document
---
#1. Estudiar el modelo de regresi贸n simple de la variable medv sobre lstat (el porcentaje de propietarios con bajo estatus socioecon贸mico).
```{r}
library(MASS)
attach(Boston)
modelo<-lm(medv~lstat)
summary(modelo)

library(ggplot2)
grafico1<-ggplot(Boston,aes(lstat,medv))+
geom_point(colour="green")+
geom_smooth(method="lm",se=F,colour="red")+
theme_bw()
plot(grafico1)


```
#2. 驴Cu谩l es la recta de regresi贸n para este modelo? 驴Qu茅 coeficiente de 2 se alcanza con este modelo?
```{r}
x1=cov(medv,lstat)/var(lstat)
x2=mean(medv)-x1*mean(lstat)
#Recta de regresion=x1*lstat+x2   ->-0.95*lstat+34.55

#Precision del modelo
library(stats)
modelo<-lm(medv~lstat)
n=length(lstat)
SCT=sum((medv-mean(medv))^2)
SCR=sum(residuals(modelo)^2)
R2=(SCT-SCR)/SCT
#El R^2 es 0,54
R2

```
#3. Supongamos que tenemos una vivienda en una nueva zona con un estatus socioecon贸mico (lstat) de 23.4, seg煤n el modelo de regresi贸n simple ajustado, 驴qu茅 predicci贸n se obtiene para la mediana del valor de una vivienda en esta zona?
```{r}
library(stats)
modelo<-lm(medv~lstat)
prediccion <- predict(modelo, newdata = nuevo_lstat)


```

#4 forma correcta
```{r}
modelo<-lm(medv~age+black+chas+crim+dis+indus+lstat+nox+ptratio+rad+rm+tax+zn)
summary(modelo)
#age chas crim  indus  tax tienen el p valor mas alto las elimino


modelo<-lm(medv~black+dis+lstat+nox+ptratio+rad+rm+zn)
summary(modelo)
#elimino rad y zn
modelo<-lm(medv~black+dis+lstat+nox+ptratio+rm)
summary(modelo)
#elimino black
modelo<-lm(medv~dis+lstat+nox+ptratio+rm)
summary(modelo)

```

#5. 驴Se aprecia una gran diferencia entre el ajuste producido por el modelo que incluye todas las variables regresoras y el modelo de regresi贸n que cuenta con las 5 variables m谩s importantes? Justifica la respuesta.
```{r}
library(MASS)
attach(Boston)
library(psych)
pairs(medv~dis+lstat+nox+ptratio+rm,main="Matriz de dispersion mejorada")
pairs(medv~age+black+chas+crim+dis+indus+nox+ptratio+rad+rm+tax+zn,main="Matriz de dispersi贸n sin mejora")
#se nota una clara mejora en los valores que toman los ejes y en el pvalor de cada variable



library(MASS)
attach(Boston)
modelo <- lm(medv ~ ., data = Boston)
summary(modelo)
#R虏 de 0.741
modelo1 <- lm(medv ~ rm + ptratio + black + lstat + tax, data = Boston)
summary(modelo1)
#R虏 de 0.716
#la diferencia entre los R虏 no es significativa
#Pero el modelo que tiene todas las variables tiene un mejor ajuste y es mas preciso
#Entonces se aprecia diferencia pero es mas ajustado usar todas las variables


```
#6. Bas谩ndote en el modelo de regresi贸n que incluye 5 variables: Estudia si se verifican las hip贸tesis del modelo. #驴Consideras que es un modelo apropiado para predecir los valores medianos de la vivienda en Boston? Justifica tu respuesta.
```{r}
library(MASS)
attach(Boston)
modelo1 <- lm(medv ~ rm + ptratio + black + lstat + tax)
res<-residuals(modelo1)
shapiro.test(res)
#Como Pvalor es < que alfa =aceptamos hip贸tesis alternativa H1
#el modelo no es consistente

t.test(res)
#como el 0 esta dentro del intervalo aceptamos que la media de los errores es 0 se cumple H0 y como el p valor esta grande rechazamos H1

#Residuos homocedasticos
bptest(modelo1,data=Boston)

#independencia del modelo
dwtest(modelo1,data=Boston)
```

